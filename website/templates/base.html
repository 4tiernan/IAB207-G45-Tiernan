<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />

    <title>{% block title %}FitTogether{% endblock %}</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
    <!-- Bootstrap Icons -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css"
    />
    <!-- App CSS -->
    <link
      rel="stylesheet"
      href="{{ url_for('static', filename='style/style.css') }}"
    />
    <!-- Favicon -->
    <link
      rel="icon"
      href="{{ url_for('static', filename='img/Header_brand_original.png') }}"
      type="image/png"
    />
  </head>

  <body class="d-flex flex-column min-vh-100">
    <!-- Header -->
    <header>
      <!-- Navbar -->
      <nav
        class="navbar navbar-expand-lg bg-body-tertiary sticky-top flex-md-nowrap"
      >
        <div class="container-fluid align-items-center">
          <!-- Brand Logo -->
          <a class="navbar-brand order-1 order-lg- me-2" href="/">
            <img
              src="{{ url_for('static', filename = 'img/Header_brand_original.png') }}"
              alt="FitTogether"
              width="120"
              height="100"
            />
          </a>

          <!-- Search-->
        <form id="searchForm" method="GET" action="{{ url_for('main.search') }}" class="order-3 order-lg-2 w-100 w-md-auto flex-grow-1 mx-md-3 mb-2 mb-lg-0" role="search">
            <div class="input-group shadow-sm rounded-pill overflow-hidden">
                <input
                id="searchInput"
                name="search"
                type="search"
                class="form-control border-0 rounded-start-pill"
                placeholder="Search events, locations…"
                aria-label="Search"
                />
                <button id="searchButton" class="btn btn-primary rounded-end-pill" type="submit" form="searchForm">
                <i class="bi bi-search"></i> Search
                </button>
            </div>
        </form>

          <!-- Secondary Navigation + Create button -->
          <div class="collapse navbar-collapse order-4 order-lg-3" id="mainNav">
            <ul class="navbar-nav mb-2 mb-lg-0">
              <!-- categories -->
              <li class="nav-item dropdown">
                <a
                  class="nav-link dropdown-toggle text-nowrap"
                  href="#"
                  id="catDrop"
                  role="button"
                  data-bs-toggle="dropdown"
                  aria-expanded="false"
                  >Categories</a
                >
                <ul class="dropdown-menu" aria-labelledby="catDrop">
                  <li><a class="dropdown-item" href="#">Running</a></li>
                  <li><a class="dropdown-item" href="#">Yoga</a></li>
                  <li><a class="dropdown-item" href="#">Strength</a></li>
                  <li><a class="dropdown-item" href="#">Cycling</a></li>
                  <li><hr class="dropdown-divider" /></li>
                  <li><a class="dropdown-item" href="#">All activities</a></li>
                </ul>
              </li>
            {% if current_user.is_authenticated %}
            <!-- Show MyEvents and BookingHistory when the user IS logged in-->
              <!-- Events -->
              <li class="nav-item">
                <a class="nav-link text-nowrap" href="{{ url_for('main.my_events')}}">My Events</a>
              </li>
              <li class="nav-item">
                <a
                  class="nav-link text-nowrap"
                  href="{{ url_for('main.bookings')}}"
                  >Booking History</a
                >
              </li>
              {% endif %}

              <!-- Create Button -->
              <li class="nav-item ms-xl-3">
                <a id="createEventButton" class="btn btn-primary text-nowrap" href="{{ url_for('main.create_event') }}">
                <i class="bi bi-plus-circle me-1"></i>Create Event
                </a>
              </li>
            </ul>
          </div>

        
        <!-- Account Cluster -->
        <ul class="navbar-nav flex-row align-items-center ms-lg-auto order-2 order-md-3 order-lg-4 ">
        {% if current_user.is_authenticated %}
        <!-- Show this when the user IS logged in -->
        <li class="nav-item dropdown">
            <button
            class="nav-link dropdown-toggle btn btn-link d-flex align-items-center text-nowrap p-0 me-3 ms-3 gap-3"
            id="userDrop"
            type="button"
            data-bs-toggle="dropdown"
            aria-expanded="false"
            >
            <img
                src="{{ url_for('static', filename='img/user_avatar.png') }}"
                width="36"
                height="36"
                alt="User"
                class="rounded-circle mb-2 me-1"
            />
            <span class="fw-semibold" >{{ current_user.name }}</span>
            </button>

            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="userDrop">
            <li>
                <a class="dropdown-item" href="#">Profile</a>
            </li>
            <li><a class="dropdown-item" href="#">Settings</a></li>
            <li><hr class="dropdown-divider" /></li>
            <li><a id="logoutButton" class="dropdown-item text-danger" href="{{ url_for('auth.logout') }}">Log out</a></li>
            </ul>
        </li>

        {% else %}
        <!-- Show this when the user is NOT logged in -->
        <li class="nav-item">
            <a id="loginNavButton" class="nav-link text-nowrap" href="{{ url_for('auth.login') }}">Log in</a>
        </li>
        <li class="nav-item">
            <a id="signupNavButton" class="btn btn-primary ms-2 text-nowrap" href="{{ url_for('auth.register') }}">Sign up</a>
        </li>
        {% endif %}
        </ul>

            <li class="nav-item d-lg-none ms-2">
              <button
                class="navbar-toggler"
                type="button"
                data-bs-toggle="collapse"
                data-bs-target="#mainNav"
                aria-controls="mainNav"
                aria-expanded="false"
                aria-label="Toggle navigation"
              >
                <span class="navbar-toggler-icon"></span>
              </button>
            </li>
          </ul>
        </div>
      </nav>
      <!-- Code for using Flask flash -->
        <div id="flashContainer" class="container-fluid mt-2">
        {% with messages = get_flashed_messages(with_categories=true) %}
            {% if messages %}
            {% for category, message in messages %}
              {% set alert_class = 'alert-warning' %} <!-- Default-->
              {% if category == 'success' %}
                {% set alert_class = 'alert-success' %}
              {% elif category == 'error' %}
                {% set alert_class = 'alert-danger' %}
              {% elif category == 'info' %}
                {% set alert_class = 'alert-info' %}
              {% endif %}

                <div id="flashMessage-{{ loop.index }}" class="alert {{alert_class}} alert-dismissible fade show" role="alert">
                {{ message }}
                <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
            {% endif %}
        {% endwith %}
        </div>
    </header>

    <main class="flex-grow-1">
      {% block content %}{% endblock %}
    </main>

    <!-- Footer -->
    <footer class="bg-light border-top py-5 mt-auto">
      <div class="container">
        <div class="row">
          <!-- Brand + Copy -->
          <div class="col-md-4 mb-3 mb-md-0">
            <a
              href="{{ url_for('main.index') }}"
              class="d-flex align-items-center mb-2 link-dark text-decoration-none"
            >
              <img
                src="{{ url_for('static', filename = 'img/Header_brand_original.png')}}"
                alt="FitTogether"
                width="150"
                height="100"
              />
            </a>
            <p class="text-muted mb-0">
              © 2025 FitTogether. All rights reserved.
            </p>
          </div>

          <!-- Explore -->
          <div class="col-6 col-md-2 mb-3">
            <h6 class="fw-bold">Explore</h6>
            <ul class="nav flex-column">
              <li class="nav-item mb-2">
                <a
                  href="{{ url_for('main.index') }}"
                  class="nav-link p-0 text-muted"
                  >Home</a
                >
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Events</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Categories</a>
              </li>
            </ul>
          </div>

          <!-- Support -->
          <div class="col-6 col-md-2 mb-3">
            <h6 class="fw-bold">Support</h6>
            <ul class="nav flex-column">
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Help Center</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">FAQs</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Contact Us</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Terms & Privacy</a>
              </li>
            </ul>
          </div>

          <!-- Community -->
          <div class="col-6 col-md-2 mb-3">
            <h6 class="fw-bold">Community</h6>
            <ul class="nav flex-column">
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Blog</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Careers</a>
              </li>
              <li class="nav-item mb-2">
                <a href="#" class="nav-link p-0 text-muted">Partnerships</a>
              </li>
            </ul>
          </div>

          <!-- Social Media -->
          <div class="col-md-2 d-flex justify-content-md-end">
            <a href="#" class="me-3 text-muted"
              ><i class="bi bi-facebook fs-4"></i
            ></a>
            <a href="#" class="me-3 text-muted"
              ><i class="bi bi-instagram fs-4"></i
            ></a>
            <a href="#" class="me-3 text-muted"
              ><i class="bi bi-twitter-x fs-4"></i
            ></a>
            <a href="#" class="text-muted"
              ><i class="bi bi-linkedin fs-4"></i
            ></a>
          </div>
        </div>
      </div>
    </footer>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
  </body>
</html>